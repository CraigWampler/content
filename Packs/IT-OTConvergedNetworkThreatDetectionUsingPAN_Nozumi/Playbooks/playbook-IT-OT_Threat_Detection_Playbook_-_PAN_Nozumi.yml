contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
id: IT-OT Threat Detection Playbook - PAN Nozumi
inputs: []
name: IT-OT Threat Detection Playbook - PAN Nozumi
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "1"
      - "6"
      - "17"
      - "4"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d2b2cc36-152b-4ad3-89d6-06a5060799ce
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: d2b2cc36-152b-4ad3-89d6-06a5060799ce
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1042.5,
          "y": 50
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d9fca320-8e88-400c-86df-4e2c4e14b3a9
      iscommand: false
      name: Validate File Sample
      type: title
      version: -1
      description: ''
    taskid: d9fca320-8e88-400c-86df-4e2c4e14b3a9
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      entry_id:
        simple: ${incident.pcapfile}
      extensions: {}
      inclusive_or_exclusive: {}
      limit: {}
      rsa_decrypt_key_entry_id: {}
      types: {}
      wpa_password: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: This automation extracts all possible files from a PCAP file.
      id: ba822d37-d857-4c36-86f2-d01119f47842
      iscommand: false
      name: Extract indicators from PCAP
      script: PcapFileExtractor
      type: regular
      version: -1
    taskid: ba822d37-d857-4c36-86f2-d01119f47842
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
  "4":
    id: "4"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 351f9eb8-8e2f-4165-88bd-55e80099f80c
      iscommand: false
      name: Host and IP  Information Enrichment
      type: title
      version: -1
      description: ''
    taskid: 351f9eb8-8e2f-4165-88bd-55e80099f80c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 190
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 191ae312-66ef-4a6f-8a24-a2b42b49df7e
      iscommand: false
      name: User information Enrichment
      type: title
      version: -1
      description: ''
    taskid: 191ae312-66ef-4a6f-8a24-a2b42b49df7e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 195
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.user
          operator: isNotEmpty
      label: "yes"
    id: "8"
    ignoreworker: false
    nexttasks:
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0ed68f8a-c292-4758-8355-b1711a54a52c
      iscommand: false
      name: Username available?
      type: condition
      version: -1
    taskid: 0ed68f8a-c292-4758-8355-b1711a54a52c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 340
        }
      }
  "9":
    defaultassigneecomplex:
      simple: ${incident.sourceusername}
    id: "9"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      attributes: {}
      custom-field-data: {}
      custom-field-type: {}
      dn: {}
      email: {}
      limit: {}
      name:
        complex:
          accessor: user}
          root: ${incident
      user-account-control-out: {}
      username: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 54d5be7b-fce9-4886-8bce-5bea7b99c082
      iscommand: true
      name: User of the source
      script: '|||ad-get-user'
      type: regular
      version: -1
    taskid: 54d5be7b-fce9-4886-8bce-5bea7b99c082
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 612.5,
          "y": 515
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      includeManual:
        simple: "yes"
      includeSuspicious:
        simple: "yes"
      maliciousQueryOverride: {}
      queryIndicators:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the investigation found any malicious indicators (file,
        URL, IP address, domain, or email). Returns "yes" if at least one malicious
        indicator is found.
      id: 31ea13ed-306e-4827-8c77-8b0ec0598b5a
      iscommand: false
      name: Is malicious
      script: IsMaliciousIndicatorFound
      type: regular
      version: -1
    taskid: 31ea13ed-306e-4827-8c77-8b0ec0598b5a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 690
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      UseLocalEnvDuplicatesInLastDays: {}
      compareEmailLabels: {}
      compareIncidentTimeDiff: {}
      compareIndicators: {}
      compareOtherLabels: {}
      ignoreClosedIncidents:
        simple: "yes"
      ipComparisonSubnetMask: {}
      maxNumberOfIncidents: {}
      maxResults:
        simple: "20"
      threshold:
        simple: "0.8"
      timeField: {}
      timeFrameHours:
        simple: "48"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Find duplicate incidents candidates.
        Using machine learning techniques with pre-defined data (can also use data from the local environment), this script takes into consideration different features such as: labels comparison, email labels (relevant for phishing), incident time difference and shared indicators, which can be customized by the arguments.
      id: 934078c4-7cb8-47d7-8eb4-9c7d7386286a
      iscommand: false
      name: Related Incidents reported from OT or IT environment
      script: GetDuplicatesMlv2
      type: regular
      version: -1
    taskid: 934078c4-7cb8-47d7-8eb4-9c7d7386286a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 865
        }
      }
  "17":
    id: "17"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d02e1a3e-5516-4a39-8ee5-2734b59ff58c
      iscommand: false
      name: URL information Enrichment
      type: title
      version: -1
      description: ''
    taskid: d02e1a3e-5516-4a39-8ee5-2734b59ff58c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1930,
          "y": 190
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: incident.labels.url
          operator: isNotEmpty
      label: "yes"
    id: "18"
    ignoreworker: false
    nexttasks:
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f137a964-4494-4c2d-8676-ba1b3a13a40a
      iscommand: false
      name: URL information available?
      type: condition
      version: -1
    taskid: f137a964-4494-4c2d-8676-ba1b3a13a40a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1930,
          "y": 340
        }
      }
  "19":
    id: "19"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        complex:
          accessor: url
          root: incident.labels
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a URL category from URL Filtering.
      id: ed85707b-2844-4e83-80d3-6e2435e1d086
      iscommand: true
      name: URL reputatiion
      script: '|||url'
      type: regular
      version: -1
    taskid: ed85707b-2844-4e83-80d3-6e2435e1d086
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1930,
          "y": 515
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 963bdb1e-47a1-4dec-8f49-0c69eeff2a5b
      iscommand: false
      name: Block indicators
      type: title
      version: -1
      description: ''
    taskid: 963bdb1e-47a1-4dec-8f49-0c69eeff2a5b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 1370
        }
      }
  "22":
    id: "22"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      EndpointId: {}
      Hostname:
        simple: ${IP} ${incident.srchostname}
      xdr_endpoint_id: {}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint using the following integrations:
        - Carbon Black Enterprise Response
        - Palo Alto Networks Traps
      id: 96a6985a-8508-4ca7-81df-bc0aab782539
      iscommand: false
      name: Isolate Endpoint - Generic
      playbookId: Isolate Endpoint - Generic
      type: playbook
      version: -1
    taskid: 96a6985a-8508-4ca7-81df-bc0aab782539
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1965
        }
      }
  "23":
    id: "23"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e4f7381-0080-4b60-8445-ff56e447a919
      iscommand: false
      name: Endpoint Isolation decison
      type: title
      version: -1
      description: ''
    taskid: 8e4f7381-0080-4b60-8445-ff56e447a919
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1375
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: User/Host Containment action recommended by Analyst.Answers.2
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: User/Host Containment action recommended by Analyst.Answers.2
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "No"
    id: "24"
    ignoreworker: false
    nexttasks:
      "No":
      - "30"
      "Yes":
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 2bb5d71f-37f0-4a0f-808b-b116bd76a4e1
      iscommand: false
      name: Is there an endpoint to isolate?
      type: condition
      version: -1
    taskid: 2bb5d71f-37f0-4a0f-808b-b116bd76a4e1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1535
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b39c0f0-e98d-4a12-8f0c-108ee579d8d0
      iscommand: false
      name: Notify endpoint user-manager-SD
      type: title
      version: -1
      description: ''
    taskid: 1b39c0f0-e98d-4a12-8f0c-108ee579d8d0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 960,
          "y": 2225
        }
      }
  "26":
    id: "26"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: " Hi ${Account.Manager}\n\nWe identified unexpected activity on one\
          \ of your team members account ${Account.Username}\n\nStarting on ${incident.occurred},\
          \ there were suspicious activity from the ${incident.src} IP address.\n\n\
          Please confirm whether or not you recognize this activity.\nReply \"Yes\"\
          \ to confirm this activity. \nReply \"No\" otherwise.\n\nThis endpoint has\
          \ been temporarily isolated until security investigation is completed and\
          \ IT service desk restore the last known good back up\n\nRegards,\nYour\
          \ friendly security team."
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: Endpoint isolated due to security incident ${incident.id}
      templateParams: {}
      to:
        simple: IT.servicedesk@nttapdemo.com ${ActiveDirectory.Users.mail}${UserManagerEmail}
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: f7fdddf7-fd97-401b-80c8-5fc3b176a76e
      iscommand: true
      name: Endpoint Isolation - Notify Manager
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: f7fdddf7-fd97-401b-80c8-5fc3b176a76e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 972.5,
          "y": 2345
        }
      }
  "27":
    id: "27"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4600688c-76ce-4dc3-8344-15185b52af34
      iscommand: false
      name: Block user
      type: title
      version: -1
      description: ''
    taskid: 4600688c-76ce-4dc3-8344-15185b52af34
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 165,
          "y": 1370
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: ip
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      IPBlacklistMiner: {}
      URL:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: url
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      URLBlacklistMiner: {}
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |
        Deprecated - We recommend using the 'Block Indicators - Generic v2' playbook instead.
        This playbook blocks malicious indicators using all integrations that are enabled.

        Supported integrations for this playbook:
        * Active Directory
        * Check Point Firewall
        * Palo Alto Networks Minemeld
        * Palo Alto Networks Panorama
        * Zscaler
        * Carbon Black Enterprise Response
      id: 65aa6598-4233-4aa6-82d9-9bcf0112676d
      iscommand: false
      name: block_indicators_-_generic
      playbookId: block_indicators_-_generic
      type: playbook
      version: -1
    taskid: 65aa6598-4233-4aa6-82d9-9bcf0112676d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 2345
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 916dcdeb-3d6b-4cdb-8ee6-cc7ed3c4a99d
      iscommand: false
      name: Review on going suspicious/malicious activities and confirm eradication/recovery
        steps
      type: title
      version: -1
      description: ''
    taskid: 916dcdeb-3d6b-4cdb-8ee6-cc7ed3c4a99d
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 580,
          "y": 2875
        }
      }
  "31":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: After investigation and taking remediation actions, Is it safe to
            add the device ${incident.labels.src_ip} back on to network and unblock
            user ${Account.Username}?
        options: []
        optionsarg:
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Remediation activities are successful?
      totalanswers: 0
    id: "31"
    ignoreworker: false
    message:
      bcc:
      body: {}
      cc:
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b493c3d9-6fb6-4554-885c-9bc4d3c82c61
      iscommand: false
      name: eradication/Recovery
      type: collection
      version: -1
    taskid: b493c3d9-6fb6-4554-885c-9bc4d3c82c61
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 580,
          "y": 3025
        }
      }
  "35":
    id: "35"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: dest_ip}
          root: ${incident.labels
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: A context script for IP entities
      id: c59adb15-9c43-4f84-8791-d01712eb0500
      iscommand: false
      name: IP reputation
      script: IPReputation
      type: regular
      version: -1
    taskid: c59adb15-9c43-4f84-8791-d01712eb0500
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1400,
          "y": 340
        }
      }
  "36":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Does the  OT incidents related to ${incident.id} generated by Nozumi
            warrants action to be taken to protect OT assets
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Does the malware incident in IT environment had an impact on OT environment
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Does the related incidents to ${incident.id} / trends or current
            on-going activities by  ${Account.Username} warrants a temporary deactivation
            of the AD account?
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Evaluate criticality of current incident and the possibility of user
          account privileges used for propagation of malware
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Does the evidence/incident trends/on-going activities warrants endpoint
            isolation
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: Do you see on--going activities that could further harm to network
          generating from the host, such as scans, account attacks
        type: singleSelect
      sender: ""
      title: User/Host Containment action recommended by Analyst
      totalanswers: 0
    id: "36"
    ignoreworker: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "27"
      - "23"
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2425efe9-706f-495c-8aff-7a5f67ed83b3
      iscommand: false
      name: User/Host Containment action recommended by Analyst
      type: collection
      version: -1
    taskid: 2425efe9-706f-495c-8aff-7a5f67ed83b3
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1040
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: User/Host Containment action recommended by Analyst.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: User/Host Containment action recommended by Analyst.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "No"
    id: "37"
    ignoreworker: false
    nexttasks:
      "No":
      - "30"
      "yes":
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9e398e8d-613b-4515-8095-6f2f673a10f9
      iscommand: false
      name: Block user account?
      type: condition
      version: -1
    taskid: 9e398e8d-613b-4515-8095-6f2f673a10f9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 165,
          "y": 1535
        }
      }
  "41":
    id: "41"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e0913b3e-0aff-4df5-81a0-fce065778b84
      iscommand: false
      name: Notify account  user-manager-SD
      type: title
      version: -1
      description: ''
    taskid: e0913b3e-0aff-4df5-81a0-fce065778b84
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 165,
          "y": 2225
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      cc: {}
      htmlBody:
        simple: " Hi ${Account.Manager}\n\nWe identified unexpected activity on one\
          \ of your team members account ${Account.Username}\n\nStarting on ${incident.occurred},\
          \ there were suspicious activity from the ${incident.src} IP address.\n\n\
          Please confirm whether or not you recognize this activity.\nReply \"Yes\"\
          \ to confirm this activity. \nReply \"No\" otherwise.\n\nThis account has\
          \ been temporarily disabled until security investigation is completed.\n\
          \nRegards,\nYour friendly security team."
      raw_message: {}
      replyTo: {}
      subject: {}
      templateParams: {}
      to:
        simple: it.servicedesk@nttapdemo.com ${ActiveDirectory.Users.mail}${UserManagerEmail}
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: ca82eb28-5ab1-4cff-8e34-81300586432a
      iscommand: true
      name: Account Block - Notify Manager
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: ca82eb28-5ab1-4cff-8e34-81300586432a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 165,
          "y": 2345
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a0fab6cf-11eb-4fc2-80a6-9e72be5da9f4
      iscommand: false
      name: OT environment investigation and Remediation
      type: title
      version: -1
      description: ''
    taskid: a0fab6cf-11eb-4fc2-80a6-9e72be5da9f4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1370
        }
      }
  "44":
    fieldMapping:
    - incidentfield: Nozumi_Alerts
      output:
        simple: ${Nozomi.Query.Result}
    id: "44"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "47"
    note: true
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      extend-context:
        simple: OT_Alerts=
      query:
        simple: alerts|head
      using:
        simple: Nozomi Networks_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Nozomi Networks
      description: |-
        Can execute a nozomi query to get all the information you want.
        A query can be something like that: "alerts | select id name status ack | where status == open"
        Take a look to n2os manual to know how to do a query.
      id: 065f6b20-3eb0-4a55-870a-c5a40ee597fc
      iscommand: true
      name: Nozumi latest alert fetching
      script: Nozomi Networks|||nozomi-query
      type: regular
      version: -1
    taskid: 065f6b20-3eb0-4a55-870a-c5a40ee597fc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1535
        }
      }
  "45":
    id: "45"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      code42alerttype: {}
      emailclassification: {}
      id:
        complex:
          accessor: id
          root: incident
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 0fa1013b-2564-4f76-8ec4-e58c251b8ee3
      iscommand: true
      name: Incident Closure
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 0fa1013b-2564-4f76-8ec4-e58c251b8ee3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 580,
          "y": 4250
        }
      }
  "46":
    id: "46"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f64a4db-a2fa-4007-8e7d-67ed57dfce66
      iscommand: false
      name: End
      type: title
      version: -1
      description: ''
    taskid: 9f64a4db-a2fa-4007-8e7d-67ed57dfce66
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 580,
          "y": 4450
        }
      }
  "47":
    form:
      description: Outcome of OT investigation via Nozumi and other available resources
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Does the impact of incident ${incident.id} to OT environment requires
            a containment plan or an impact mitigation plan
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: OT incident investigation outcomes
      totalanswers: 0
    id: "47"
    ignoreworker: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a8e7de6d-a36a-4919-8225-94471c5659fa
      iscommand: false
      name: Containment and Impact mitigation actions in OT environment
      type: collection
      version: -1
    taskid: a8e7de6d-a36a-4919-8225-94471c5659fa
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1705
        }
      }
  "48":
    id: "48"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1758bb3d-abab-4fea-88d2-174a90d04a6a
      iscommand: false
      name: Notify OT management team
      type: title
      version: -1
      description: ''
    taskid: 1758bb3d-abab-4fea-88d2-174a90d04a6a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 2235
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: "Investigation of incident ${incident.id} uncovered some impact on\
          \ OT environment. \n\n${OT impact assessment.Answers.0}"
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: OT environment impact assessment - ${indcident.id}
      templateParams: {}
      to:
        simple: ot.management@nttapdemo.com
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 9d72d4ff-802f-4bc0-8d82-a519c748108d
      iscommand: true
      name: OT Impact notification
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 9d72d4ff-802f-4bc0-8d82-a519c748108d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 2345
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: OT incident investigation outcomes.Answers
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: OT incident investigation outcomes.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "No"
    id: "50"
    ignoreworker: false
    nexttasks:
      "No":
      - "30"
      "yes":
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 77afbbf7-1359-44b8-872e-7f5367358652
      iscommand: false
      name: Impact to OT environment
      type: condition
      version: -1
    taskid: 77afbbf7-1359-44b8-872e-7f5367358652
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 1860
        }
      }
  "51":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: What is the identified impact for OT environment by incident ${incident.id}
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: shortText
      sender: ""
      title: OT impact assessment
      totalanswers: 0
    id: "51"
    ignoreworker: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b1e04d0b-eceb-4918-84aa-9c7c41fdded4
      iscommand: false
      name: Impact statement for OT environment
      type: collection
      version: -1
    taskid: b1e04d0b-eceb-4918-84aa-9c7c41fdded4
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1630,
          "y": 2045
        }
      }
  "52":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Remediation activities successful?
        options:
        - "Yes"
        - "No"
        optionsarg: []
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Remediation activities successful?
      totalanswers: 0
    id: "52"
    ignoreworker: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods: []
      subject:
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b4f63942-13b2-414c-8534-9f5d15760330
      iscommand: false
      name: Continue with remediation activities
      type: collection
      version: -1
    taskid: b4f63942-13b2-414c-8534-9f5d15760330
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3630
        }
      }
  "53":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Remediation activities successful?.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Remediation activities successful?.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: "No"
    id: "53"
    ignoreworker: false
    nexttasks:
      "No":
      - "54"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7df6c659-9dec-4e37-8860-e404f6928ae5
      iscommand: false
      name: Remediation activities successful?
      type: condition
      version: -1
    taskid: 7df6c659-9dec-4e37-8860-e404f6928ae5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3800
        }
      }
  "54":
    id: "54"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6737e07c-cb5b-4618-8719-08f78c5e85a5
      iscommand: false
      name: Escalate to Major Incident team
      type: title
      version: -1
      description: ''
    taskid: 6737e07c-cb5b-4618-8719-08f78c5e85a5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3960
        }
      }
  "55":
    id: "55"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: Actions taken to remediate incident ${incident.id} have only been
          partially successful, we would like to bring this to your attention and
          request an escalation to this incident
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: 'persistent malicious behavior continues from devices/user accounts
          involved in ${incident.id}  '
      templateParams: {}
      to:
        simple: major.incident@nttapdemo.com
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 4c4dd243-43eb-472e-83a2-9a8df78c06f2
      iscommand: true
      name: Send Notification to Major Incident team
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 4c4dd243-43eb-472e-83a2-9a8df78c06f2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 4070
        }
      }
  "56":
    id: "56"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      base-dn: {}
      username:
        complex:
          accessor: user
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Active Directory Query v2
      description: Disables an Active Directory user account.
      id: db89378a-6a04-453a-8523-fbafdd522730
      iscommand: true
      name: ad-disable-account
      script: Active Directory Query v2|||ad-disable-account
      type: regular
      version: -1
    taskid: db89378a-6a04-453a-8523-fbafdd522730
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 165,
          "y": 1965
        }
      }
  "57":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: pcap_id}
                root: ${incident.labels
          operator: isNotEqualString
          right:
            value:
              simple: "0"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: pcap_id}
                root: ${incident.labels
          operator: isEqualString
          right:
            value:
              simple: "0"
      label: else
    id: "57"
    ignoreworker: false
    nexttasks:
      else:
      - "30"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d6d4368-838a-464b-8d27-edf99f9a60e9
      iscommand: false
      name: PCAP available
      type: condition
      version: -1
    taskid: 6d6d4368-838a-464b-8d27-edf99f9a60e9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 340
        }
      }
  "58":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Remediation activities are successful?.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Remediation activities are successful?.Answers.0
          operator: isEqualString
          right:
            value:
              simple: "No"
      label: else
    id: "58"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "59"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02a6cdec-7299-4151-889a-54382d2a5e77
      iscommand: false
      name: Eradication/Recovery successful?
      type: condition
      version: -1
    taskid: 02a6cdec-7299-4151-889a-54382d2a5e77
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 580,
          "y": 3260
        }
      }
  "59":
    id: "59"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      cc: {}
      htmlBody: {}
      raw_message: {}
      replyTo: {}
      subject: {}
      templateParams: {}
      to:
        simple: it.servicedesk@nttapdemo.com ot.managment@nttapdemo.com ${ActiveDirectory.Users.mail}${UserManagerEmail}
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 54c824e8-0198-456c-81b5-83bb8fbc0991
      iscommand: true
      name: Notify stakeholders of the incident about recurring related activities
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 54c824e8-0198-456c-81b5-83bb8fbc0991
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3410
        }
      }
  "60":
    id: "60"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 36ce0dd2-d051-482f-82a8-9f7bbf8a5392
      iscommand: false
      name: Active Directory - Get User Manager Details
      playbookId: Active Directory - Get User Manager Details
      type: playbook
      version: -1
      description: ''
    taskid: 36ce0dd2-d051-482f-82a8-9f7bbf8a5392
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 960,
          "y": 690
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "24_30_No": 0.22,
      "37_30_No": 0.35,
      "50_30_No": 0.21,
      "53_45_yes": 0.41,
      "57_30_else": 0.27,
      "58_45_yes": 0.36
    },
    "paper": {
      "dimensions": {
        "height": 4465,
        "width": 2580,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
description: 6.0.0

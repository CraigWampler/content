category: Utilities
commonfields:
  id: Server Message Block (SMB) 2.0
  version: -1
configuration:
- display: Server IP / Hostname (e.g. 1.2.3.4)
  name: hostname
  required: false
  type: 0
- defaultvalue: "445"
  display: Port
  name: port
  required: true
  type: 0
- display: Server NetBIOS (AD) Name
  name: nbname
  required: false
  type: 0
- display: Domain
  name: domain
  required: false
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: File exchange with an SMB server.
display: Server Message Block (SMB) 2.0
name: Server Message Block (SMB) 2.0
script:
  commands:
  - arguments:
    - description: 'Server IP address / hostname, for example: 1.2.3.4.'
      name: hostname
    - description: Server NetBIOS (AD) name.
      name: nbname
    - description: The host domain
      name: domain
    - default: true
      description: 'The path to the file, starting from the share, for example: Share/Folder/File.'
      name: file_path
      required: true
    - auto: PREDEFINED
      defaultValue: "yes"
      description: If "yes", the file is downloaded and attached. If "no", only the
        output is attached. Default is yes".
      name: download_and_attach
      predefined:
      - "yes"
      - "no"
    description: Downloads a file from the SMB server.
    name: smb-download
    outputs:
    - contextPath: File.Size
      description: File size.
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file.
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file.
      type: string
    - contextPath: File.Name
      description: File name.
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file.
      type: string
    - contextPath: File.EntryID
      description: File entry ID.
      type: string
    - contextPath: File.Info
      description: Information about the file.
      type: string
    - contextPath: File.Type
      description: File type.
      type: string
    - contextPath: File.MD5
      description: MD5 hash of the file.
      type: string
  - arguments:
    - description: 'Server IP address / hostname, for example: 1.2.3.4.'
      name: hostname
    - description: Server NetBIOS (AD) name.
      name: nbname
    - description: The host domain
      name: domain
    - description: 'The path to the file, starting from the share, for example: Share/Folder/File.'
      name: file_path
      required: true
    - description: EntryID of the file to send to the share.
      name: entryID
    - description: File content to send to the share. Ignored if EntryID argument
        is specified.
      name: content
    description: Uploads a file to the SMB server.
    name: smb-upload
  - arguments:
    - description: 'The path , starting from the share, for example: /Folder'
      name: file_path
      required: true
    - description: 'The share name , for example: Share'
      name: file_share
      required: true
    description: Lists the files in specified path on the SMB server.
    name: smb-list-files
    outputs:
    - contextPath: SMB.File.Name
      description: File name.
      type: string
    - contextPath: SMB.File.Path
      description: File path.
    - contextPath: SMB.File.Size
      description: File size.
  - arguments: []
    description: Lists the shares on the SMB server.
    name: smb-list-shares
  - arguments:
    - description: 'The path including the file, starting from the share, for example:
        Share/Folder/filename'
      name: file_path
    description: Deleted file from SMB share.
    name: smb-delete-files
  dockerimage: demisto/smb:1.0.0.7685
  runonce: false
  script: ''
  subtype: python2
  type: python
fromversion: 5.0.0
tests:
- No tests (auto formatted)

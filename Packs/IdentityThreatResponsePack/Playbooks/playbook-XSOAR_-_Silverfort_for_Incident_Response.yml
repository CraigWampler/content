contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
description: The Code42 Exfiltration playbook acts on Code42 Security Alerts, retrieves
  file event data, and allows security teams to remediate file exfiltration events
  by revoking access rights to cloud files or containing endpoints.
id: XSOAR - Silverfort for Incident Response
inputs:
- description: Maximum number of network hosts to contain.
  key: ContainHostsMax
  playbookInputQuery:
  required: false
  value:
    simple: "2"
- description: URL of Demisto instance for emails.
  key: DemistoInstanceURL
  playbookInputQuery:
  required: false
  value:
    simple: https://dagobah.demisto.works/
name: XSOAR - Silverfort for Incident Response
outputs: []
rolename:
- Administrator
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "37"
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab4c0d6a-996e-415c-8f44-8a76d279ca15
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: ab4c0d6a-996e-415c-8f44-8a76d279ca15
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 260,
          "y": -190
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "24"
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 97d515c7-feb7-48bc-80a6-f7b0c7f111fc
      iscommand: false
      name: Start Remediation Timer
      tags:
      - exfiltration
      type: title
      version: -1
      description: ''
    taskid: 97d515c7-feb7-48bc-80a6-f7b0c7f111fc
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 260,
          "y": 260
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b6a7b214-a52b-48cc-8c0b-bc966c11ff90
      iscommand: false
      name: Malicious Behavior Determined
      type: title
      version: -1
      description: ''
    taskid: b6a7b214-a52b-48cc-8c0b-bc966c11ff90
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 265,
          "y": 690
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dbffe514-03bd-4aa0-8d56-4ea00eb5d889
      iscommand: false
      name: Analyst review
      type: regular
      version: -1
    taskid: dbffe514-03bd-4aa0-8d56-4ea00eb5d889
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1680
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1905e906-499f-4c14-8ec1-9c02eb6ef22a
      iscommand: false
      name: Stop Remediation Timer
      type: title
      version: -1
      description: ''
    taskid: 1905e906-499f-4c14-8ec1-9c02eb6ef22a
    timertriggers:
    - action: stop
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1535
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: UserManagerEmail
          operator: isExists
      label: "yes"
    id: "23"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "33"
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ce5fa797-bd44-48ba-8ebe-62cbe6f986e5
      iscommand: false
      name: Does Manager Email Exist?
      type: condition
      version: -1
    taskid: ce5fa797-bd44-48ba-8ebe-62cbe6f986e5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 835
        }
      }
  "24":
    id: "24"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${incident.details}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 98e4466b-0f60-4ffe-8e1f-9251597de0f5
      iscommand: false
      name: Retrieve alert details
      script: Print
      type: regular
      version: -1
    taskid: 98e4466b-0f60-4ffe-8e1f-9251597de0f5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 510
        }
      }
  "26":
    id: "26"
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      assetid: {}
      closeNotes:
        simple: All stakeholders have been updated
      closeReason:
        simple: Endpoint contained. Manager updated
      code42alerttype: {}
      emailclassification: {}
      id:
        complex:
          accessor: id
          root: incident
      phishingsubtype: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 97ca62de-2914-474a-875c-ef3599470351
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 97ca62de-2914-474a-875c-ef3599470351
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2205
        }
      }
  "29":
    continueonerror: true
    evidencedata:
      customfields: {}
      description:
        simple: alert the manager
    id: "29"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "30"
    note: true
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body:
        simple: |-
          Data exfiltration activity has been detected by Code42 for user ${incident.labels.actor}. File exfiltration details:

          Files:
          ${incident.code42fileevents.filename}

          Paths:
          ${incident.code42fileevents.filepath}

          Exposures:
          ${incident.code42fileevents.exposure}

          If you have access to Demisto, you can view the incident details at ${inputs.DemistoInstanceURL}#/incident/${incident.id}
      bodyType: {}
      cc: {}
      flag: {}
      from: {}
      headers: {}
      htmlBody: {}
      importance: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: ${incident.name}
      templateParams: {}
      to:
        simple: ${UserManagerEmail}
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
      using:
        simple: Mail Sender (New)_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 2a556db2-6273-48a7-8fcf-595d08b25662
      iscommand: true
      name: Send email to manager
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 2a556db2-6273-48a7-8fcf-595d08b25662
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 1185
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea60127b-366c-4a94-85db-339b32ca66c5
      iscommand: false
      name: Confirm Remediation Is Complete
      type: regular
      version: -1
    taskid: ea60127b-366c-4a94-85db-339b32ca66c5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1360
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Mail Sender (New)
                - - left:
                      iscontext: true
                      value:
                        simple: state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: brand
                    operator: isEqualString
                    right:
                      value:
                        simple: EWS Mail Sender
                - - left:
                      iscontext: true
                      value:
                        simple: state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
        - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: brand
                    operator: isEqualString
                    right:
                      value:
                        simple: Gmail
                - - left:
                      iscontext: true
                      value:
                        simple: state
                    operator: isEqualString
                    right:
                      value:
                        simple: active
                root: modules
          operator: isExists
      label: "yes"
    id: "33"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: df73e338-6ae3-4d35-8d01-76e97fc62866
      iscommand: false
      name: Is email integration enabled?
      type: condition
      version: -1
    taskid: df73e338-6ae3-4d35-8d01-76e97fc62866
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1010
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 657fc1fc-1430-408d-8e3e-6dd0d3d8228d
      iscommand: false
      name: 67c4f402-755b-4fb9-8d0d-4981167a6ecf
      playbookId: 67c4f402-755b-4fb9-8d0d-4981167a6ecf
      type: playbook
      version: -1
      description: ''
    taskid: 657fc1fc-1430-408d-8e3e-6dd0d3d8228d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 530,
          "y": 510
        }
      }
  "35":
    continueonerror: true
    id: "35"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name: {}
      type: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: 224d2d54-c200-474e-824b-6ccde86e380d
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: 224d2d54-c200-474e-824b-6ccde86e380d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1855
        }
      }
  "36":
    id: "36"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      bodyType: {}
      cc: {}
      flag: {}
      from: {}
      headers: {}
      htmlBody: {}
      importance: {}
      raw_message: {}
      replyTo: {}
      subject: {}
      templateParams: {}
      to:
        simple: pramukh@demisto.com
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
      using:
        simple: Mail Sender (New)_instance_1
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 6e065121-01d8-4483-879f-97efabe774c8
      iscommand: true
      name: Email summary report to the cross functional teams
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 6e065121-01d8-4483-879f-97efabe774c8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2030
        }
      }
  "37":
    continueonerror: true
    defaultassigneecomplex: {}
    id: "37"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      assignBy: {}
      email: {}
      onCall: {}
      roles: {}
      username:
        simple: admin
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default,  the analyst is picked randomly from the available users, according to the provided roles (if no roles provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculated and decide who is the best analyst for the job.
        top-user: The user that is most commonly owns this type of incident
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles (if no roles provided, will fetch all users).
        current: The user that executed the command
      id: a7ca53cc-d97e-40c9-8606-d8ff72c5e548
      iscommand: false
      name: Assign Incident Owner
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: a7ca53cc-d97e-40c9-8606-d8ff72c5e548
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": -50
        }
      }
  "40":
    id: "40"
    ignoreworker: false
    nexttasks:
      service account:
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6c353e34-2928-4d4c-8416-669f3335412d
      iscommand: false
      name: Check whether human account or service account ?
      type: title
      version: -1
      description: ''
    taskid: 6c353e34-2928-4d4c-8416-669f3335412d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 260,
          "y": 45
        }
      }
  "41":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Ask manager
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Ask manager
      totalanswers: 0
    id: "41"
    ignoreworker: false
    message:
      bcc:
      body:
      cc:
      format: ""
      methods:
      - email
      replyOptions:
      - "Yes"
      - "No"
      subject:
        simple: Ask manager
      timings:
        completeafterreplies: 1
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Administrator
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0105954b-1adf-4266-88d2-740f2ea1ac6d
      iscommand: false
      name: Ask manager
      type: collection
      version: -1
    taskid: 0105954b-1adf-4266-88d2-740f2ea1ac6d
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 620,
          "y": 895
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    nexttasks:
      "No":
      - "44"
      "Yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: cc61427a-3d30-47dd-88ed-23e8ec5960fe
      iscommand: false
      name: Check response
      type: condition
      version: -1
    taskid: cc61427a-3d30-47dd-88ed-23e8ec5960fe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 620,
          "y": 1070
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 62589ec8-04dc-456a-8d2d-fe752d3bc03d
      iscommand: false
      name: Remove user from watchlist allow authentications
      type: regular
      version: -1
    taskid: 62589ec8-04dc-456a-8d2d-fe752d3bc03d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 620,
          "y": 1340
        }
      }
  "44":
    id: "44"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    scriptarguments:
      domain: {}
      email:
        simple: ron@ad.acaws.silverfort.io
      sam_account: {}
      upn:
        simple: ron@ad.acaws.silverfort.io
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: User risk commands - get the user entity risk.
      id: 7fe54ab7-70b0-47d8-81d4-ae9b172bda81
      iscommand: true
      name: Get Silverfort risk score and indicators
      script: '|||silverfort-get-user-risk'
      type: regular
      version: -1
    taskid: 7fe54ab7-70b0-47d8-81d4-ae9b172bda81
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 1210
        }
      }
  "45":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: "1"
          operator: isExists
      label: "yes"
    id: "45"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "46"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de967f2e-de23-4179-86e9-eacf87e7f129
      iscommand: false
      name: 'Is risk score critical ? '
      type: condition
      version: -1
    taskid: de967f2e-de23-4179-86e9-eacf87e7f129
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 1415
        }
      }
  "46":
    id: "46"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53aa909f-77f0-4dda-81a1-67419f82d0f7
      iscommand: false
      name: Block user
      type: regular
      version: -1
    taskid: 53aa909f-77f0-4dda-81a1-67419f82d0f7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1500,
          "y": 2125
        }
      }
  "48":
    id: "48"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "49"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: Insider Threat
      domain_name:
        simple: ron@ad.acaws.silverfort.io
      resource_name:
        simple: ron@ad.acaws.silverfort.io
      risk_name:
        simple: InsiderThreat
      severity:
        simple: low
      valid_for:
        simple: "2"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update the resource entity risk.
      id: 5b329cf4-c872-45d9-8df5-2525609f8c06
      iscommand: true
      name: Raise the risk score in Silverfort
      script: '|||silverfort-update-resource-risk'
      type: regular
      version: -1
    taskid: 5b329cf4-c872-45d9-8df5-2525609f8c06
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1610
        }
      }
  "49":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: "1"
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: "yes"
    id: "49"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 715c5566-a27f-4341-8ee3-b96cb83c0b23
      iscommand: false
      name: Has the user identity been verified ?
      type: condition
      version: -1
    taskid: 715c5566-a27f-4341-8ee3-b96cb83c0b23
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 1810
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: "1"
          operator: isEqualString
          right:
            value:
              simple: "1"
      label: "yes"
    id: "50"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "44"
      "yes":
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 42bf9c42-3795-46f5-8a27-2d7fb9e20e0f
      iscommand: false
      name: Check in Silverfort if its a service account ?
      type: condition
      version: -1
    taskid: 42bf9c42-3795-46f5-8a27-2d7fb9e20e0f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 720
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2490,
        "width": 2480,
        "x": -540,
        "y": -190
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0

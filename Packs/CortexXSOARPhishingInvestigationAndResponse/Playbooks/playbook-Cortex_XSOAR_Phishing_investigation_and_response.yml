contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
id: Cortex XSOAR Phishing investigation and response
inputs: []
name: Cortex XSOAR Phishing investigation and response
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "6"
      - "8"
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5420373e-ef78-4304-8987-8eb3a30e34e1
      iscommand: false
      name: ""
      version: -1
      description: ''
    taskid: 5420373e-ef78-4304-8987-8eb3a30e34e1
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 837.5,
          "y": 50
        }
      }
  "1":
    evidencedata:
      customfields: {}
      description:
        simple: SlashNext Phishing URL investigation response
    id: "1"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "3"
    note: true
    quietmode: 0
    scriptarguments:
      extended_info:
        simple: "true"
      url:
        complex:
          accessor: Data}
          root: ${URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Performs a real-time URL scan with SlashNext cloud-based SEER Engine.
        If the specified URL already exists in the cloud database, scan results will
        be returned immediately. If not, this command will submit a URL scan request
        and return with the message "check back later" and include a unique Scan ID.
        You can check the results of this scan using the "slashnext-scan-report" command
        anytime after 60 seconds using the returned Scan ID.
      id: e3f9b431-a1b0-4be6-81d4-91ccd2d8e0dc
      iscommand: true
      name: Investigate the URL on SlashNext
      script: '|||slashnext-url-scan'
      type: regular
      version: -1
    taskid: e3f9b431-a1b0-4be6-81d4-91ccd2d8e0dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 275,
          "y": 370
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "5"
      "yes":
      - "11"
      - "19"
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: URL.Verdict}
          root: ${SlashNext
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 45673ae0-a9f2-4f05-8849-a71eb2928311
      iscommand: false
      name: Malicious URL found ?
      script: Exists
      type: condition
      version: -1
    taskid: 45673ae0-a9f2-4f05-8849-a71eb2928311
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 275,
          "y": 545
        }
      }
  "5":
    id: "5"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f41ab239-1026-4998-8d23-e3de92158745
      iscommand: false
      name: Close Investigation
      type: title
      version: -1
      description: ''
    taskid: f41ab239-1026-4998-8d23-e3de92158745
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1595
        }
      }
  "6":
    id: "6"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: Data}
          root: ${URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 0230c13a-8984-4879-8cab-83f75ee8035a
      iscommand: false
      name: 'Does the email contain URLs? '
      script: Exists
      type: condition
      version: -1
    taskid: 0230c13a-8984-4879-8cab-83f75ee8035a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 295,
          "y": 195
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d8929626-cfd2-4c16-85bb-14d446f5169f
      iscommand: false
      name: Not found
      type: title
      version: -1
      description: ''
    taskid: d8929626-cfd2-4c16-85bb-14d446f5169f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 725,
          "y": 385
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    nexttasks:
      '#default#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${File.EntryID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 605cd5ed-2d4f-4d2c-8c6b-fc0e51325a61
      iscommand: false
      name: 'Does the email contain file attachments? '
      script: Exists
      type: condition
      version: -1
    taskid: 605cd5ed-2d4f-4d2c-8c6b-fc0e51325a61
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 725,
          "y": 195
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      height: {}
      htmlBody:
        simple: ${incident.labels.Email/html}
      offline: {}
      type: {}
      width: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Converts the body of an email to an image file or a PDF file.
      id: 224f040c-9e36-4cca-8f8e-e1c46a1a85a9
      iscommand: true
      name: Rasterize email body
      script: '|||rasterize-email'
      type: regular
      version: -1
    taskid: 224f040c-9e36-4cca-8f8e-e1c46a1a85a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1155,
          "y": 195
        }
      }
  "11":
    id: "11"
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      accountgroups: {}
      accountid: {}
      accountname: {}
      activedirectoryaccountstatus: {}
      activedirectorydisplayname: {}
      activedirectorypasswordstatus: {}
      addLabels: {}
      affecteddata: {}
      affecteddatatype: {}
      affectedindividualscontactinformation: {}
      agentid: {}
      app: {}
      approximatenumberofaffecteddatasubjects: {}
      assetid: {}
      attachmentcount: {}
      attachmentextension: {}
      attachmenthash: {}
      attachmentid: {}
      attachmentname: {}
      attachmentsize: {}
      attachmenttype: {}
      blockedaction: {}
      bugtraq: {}
      city: {}
      clarotyalertresolved: {}
      clarotyalerttype: {}
      clarotycategory: {}
      clarotynetworkid: {}
      clarotyrelatedassets: {}
      clarotyresourceid: {}
      clarotysiteid: {}
      closeNotes: {}
      closeReason: {}
      code42alerttype: {}
      code42fileevents: {}
      commandline: {}
      companyaddress: {}
      companycity: {}
      companycountry: {}
      companyhasinsuranceforthebreach: {}
      companyname: {}
      companypostalcode: {}
      companypropertystatus: {}
      contactaddress: {}
      contactname: {}
      coordinates: {}
      country: {}
      countrywherebusinesshasitsmainestablishment: {}
      countrywherethebreachtookplace: {}
      criticalassets: {}
      customFields: {}
      cve: {}
      cvss: {}
      cymulateimmediatethreatsattackid: {}
      cymulateimmediatethreatsfiletype: {}
      cymulateimmediatethreatsid: {}
      cymulateimmediatethreatsmitigations: {}
      cymulateimmediatethreatsmodule: {}
      cymulateimmediatethreatspayloadname: {}
      cymulateimmediatethreatsstatus: {}
      cymulateimmediatethreatsvector: {}
      dataencryptionstatus: {}
      datetimeofthebreach: {}
      dbotprediction: {}
      dbotpredictionprobability: {}
      dbottextsuggestionhighlighted: {}
      deleteEmptyField: {}
      dest: {}
      desthostname: {}
      destinationip: {}
      destntdomain: {}
      destos: {}
      details: {}
      detectionendtime: {}
      detectionid: {}
      detectionticketed: {}
      detectionupdatetime: {}
      detectionurl: {}
      devicegsuiteaccountstatus: {}
      devicename: {}
      dpoemailaddress: {}
      duoaccountstatus: {}
      duration: {}
      emailaddress: {}
      emailauthenticitycheck: {}
      emailautoreply: {}
      emailbcc: {}
      emailbody: {}
      emailbodyformat: {}
      emailbodyhtml: {}
      emailcc: {}
      emailclassification: {}
      emailclientname: {}
      emailfrom: {}
      emailheaders: {}
      emailhtml: {}
      emailinreplyto: {}
      emailkeywords: {}
      emailmessageid: {}
      emailreceived: {}
      emailreplyto: {}
      emailreturnpath: {}
      emailsenderip: {}
      emailsize: {}
      emailsource: {}
      emailsubject: {}
      emailto: {}
      emailtocount: {}
      emailurlclicked: {}
      employeedisplayname: {}
      employeeemail: {}
      employeemanageremail: {}
      exfiltratedfiles: {}
      expanseexposuretype: {}
      expanserawjsonevent: {}
      expanseseverity: {}
      extrahopapplianceid: {}
      extrahophostname: {}
      filehash: {}
      filename: {}
      filepath: {}
      filesize: {}
      firstseen: {}
      globaldirectoryvisibility: {}
      googleaccountstatus: {}
      googleadminrolesstatus: {}
      googledisplayname: {}
      googledrivestatus: {}
      googlemailstatus: {}
      googlepasswordstatus: {}
      helloworldid: {}
      helloworldstatus: {}
      helloworldtype: {}
      hostname: {}
      id:
        simple: ${incident.id}
      indenideviceid: {}
      indeniissueid: {}
      infectedhosts: {}
      investigationstage: {}
      isolated: {}
      isthedatasubjecttodpia: {}
      labels: {}
      lastmodifiedby: {}
      lastmodifiedon: {}
      lastseen: {}
      likelyimpact: {}
      loginattemptcount: {}
      macaddress: {}
      mailboxdelegation: {}
      maliciousbehavior: {}
      maliciouscauseifthecauseisamaliciousattack: {}
      malwarefamily: {}
      measurestomitigate: {}
      name: {}
      niststage: {}
      occurred: {}
      offboardingdate: {}
      offboardingstage: {}
      oktaaccountstatus: {}
      owner: {}
      parentprocessid: {}
      participants: {}
      passwordexpirationstatus: {}
      phase: {}
      phishingsubtype: {}
      pid: {}
      policydeleted: {}
      policydescription: {}
      policydetails: {}
      policyid: {}
      policyrecommendation: {}
      policyremediable: {}
      policyseverity: {}
      policytype: {}
      possiblecauseofthebreach: {}
      postalcode: {}
      previouscoordinates: {}
      previouscountry: {}
      previoussignindatetime: {}
      previoussourceip: {}
      prismacloudcomputeactivitytype: {}
      prismacloudcomputeappid: {}
      prismacloudcomputecategory: {}
      prismacloudcomputecollections: {}
      prismacloudcomputecommand: {}
      prismacloudcomputecontainer: {}
      prismacloudcomputecredentialid: {}
      prismacloudcomputedistribution: {}
      prismacloudcomputeerror: {}
      prismacloudcomputeforensic: {}
      prismacloudcomputefqdn: {}
      prismacloudcomputefunction: {}
      prismacloudcomputehost: {}
      prismacloudcomputeimage: {}
      prismacloudcomputeinteractive: {}
      prismacloudcomputekubernetesresource: {}
      prismacloudcomputelabels: {}
      prismacloudcomputeline: {}
      prismacloudcomputelogfile: {}
      prismacloudcomputemarkdown: {}
      prismacloudcomputemessage: {}
      prismacloudcomputeproject: {}
      prismacloudcomputeprotected: {}
      prismacloudcomputeprovider: {}
      prismacloudcomputerawalertjson: {}
      prismacloudcomputeregion: {}
      prismacloudcomputeregistry: {}
      prismacloudcomputerule: {}
      prismacloudcomputeruntime: {}
      prismacloudcomputeservice: {}
      prismacloudcomputeservicetype: {}
      prismacloudcomputetotal: {}
      prismacloudcomputetype: {}
      prismacloudcomputeuser: {}
      prismacloudid: {}
      prismacloudreason: {}
      prismacloudrules: {}
      prismacloudstatus: {}
      prismacloudtime: {}
      rating: {}
      rawparticipants: {}
      region: {}
      regionid: {}
      replacePlaybook: {}
      reporteremailaddress: {}
      resourceapiname: {}
      resourcecloudtype: {}
      resourceid: {}
      resourcename: {}
      resourcetype: {}
      riskrating: {}
      riskscore: {}
      roles: {}
      rrn: {}
      safebreachsimulationid: {}
      samaccountname: {}
      sansstage: {}
      sectorofaffectedparty: {}
      severity:
        simple: "4"
      signature: {}
      signindatetime: {}
      sixgillalertid: {}
      sixgillcontent: {}
      sixgillthreatlevel: {}
      sixgillthreattype: {}
      sizenumberofemployees: {}
      sizeturnover: {}
      skuname: {}
      skutier: {}
      sla: {}
      slaField: {}
      sourcehostname: {}
      sourceip: {}
      src: {}
      srchostname: {}
      srcntdomain: {}
      srcos: {}
      srcuser: {}
      subscriptionassignedby: {}
      subscriptioncreatedby: {}
      subscriptioncreatedon: {}
      subscriptiondescription: {}
      subscriptionid: {}
      subscriptionname: {}
      subscriptiontype: {}
      subscriptionupdatedby: {}
      subscriptionupdatedon: {}
      subtype: {}
      successfullogin: {}
      systemdefault: {}
      systems: {}
      targetfirewallversion: {}
      telephoneno: {}
      terminatedaction: {}
      threatactor: {}
      trapsid: {}
      travelmaplink: {}
      triggeredsecurityprofile: {}
      type: {}
      urlsslverification: {}
      user: {}
      useraccountcontrol: {}
      userdisabledstatus: {}
      username: {}
      vendorid: {}
      vendorproduct: {}
      vpcid: {}
      vulnerabilitycategory: {}
      whereisdatahosted: {}
      xdralertcount: {}
      xdralerts: {}
      xdrassigneduseremail: {}
      xdrassigneduserprettyname: {}
      xdrdescription: {}
      xdrdetectiontime: {}
      xdrfileartifacts: {}
      xdrhighseverityalertcount: {}
      xdrhostcount: {}
      xdrincidentid: {}
      xdrlowseverityalertcount: {}
      xdrmediumseverityalertcount: {}
      xdrnetworkartifacts: {}
      xdrnotes: {}
      xdrresolvecomment: {}
      xdrstatus: {}
      xdrurl: {}
      xdrusercount: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an incident
      id: 3bf137ba-1dc5-444f-832f-6b9e1fc027a9
      iscommand: true
      name: setIncident to high severity
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 3bf137ba-1dc5-444f-832f-6b9e1fc027a9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 949028b5-80c4-40ae-8918-92a2be1e8fac
      iscommand: false
      name: Analyst Review
      type: regular
      version: -1
    taskid: 949028b5-80c4-40ae-8918-92a2be1e8fac
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1070
        }
      }
  "15":
    defaultassigneecomplex:
      simple: admin
    id: "15"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        simple: ${incident.id}
      name: {}
      type: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate investigation summary report in an automated way
        Can be used in post-processing flow as well.
      id: d72039a2-6997-4541-8aaf-0e41fabf853a
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: d72039a2-6997-4541-8aaf-0e41fabf853a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1245
        }
      }
  "16":
    id: "16"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      additionalHeader: {}
      attachCIDs: {}
      attachIDs: {}
      attachNames: {}
      bcc: {}
      body: {}
      bodyType:
        simple: text
      cc: {}
      flag: {}
      from:
        simple: admin@xsoar.com
      headers: {}
      htmlBody: {}
      importance: {}
      raw_message: {}
      replyTo: {}
      subject:
        simple: 'Investigation Summary Report for ${Re: Phishing Investigation - ${incident.name}}'
      templateParams: {}
      to:
        simple: pramukh@demisto.com
      transientFile: {}
      transientFileCID: {}
      transientFileContent: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Mail Sender (New)
      description: Send an email
      id: 2317194c-2a9b-41bb-8dac-44b9e8980ad5
      iscommand: true
      name: Email the report to stakeholders
      script: Mail Sender (New)|||send-mail
      type: regular
      version: -1
    taskid: 2317194c-2a9b-41bb-8dac-44b9e8980ad5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 1420
        }
      }
  "19":
    evidencedata:
      customfields: {}
      description:
        simple: SlashNext URL Scan Report
    id: "19"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "23"
    note: true
    quietmode: 0
    scriptarguments:
      extended_info:
        simple: "true"
      scanid:
        simple: ${SlashNext.URL.ScanID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieves the results of a URL scan against a previous scan request.
        If the scan is finished, results will be returned immediately; otherwise the
        message "check back later" will be returned.
      id: 8cfb4b2c-8f94-4b4e-8350-cd8bd8d1165e
      iscommand: true
      name: Fetch Scan Report from Slashnext
      script: '|||slashnext-scan-report'
      type: regular
      version: -1
    taskid: 8cfb4b2c-8f94-4b4e-8350-cd8bd8d1165e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 720
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bdc07d87-fb41-4be2-873f-491caf789aaf
      iscommand: false
      name: Perform a search for the URL in O365 Mailbox
      type: title
      version: -1
      description: ''
    taskid: bdc07d87-fb41-4be2-873f-491caf789aaf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 500,
          "y": 735
        }
      }
  "21":
    id: "21"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      folder-path: {}
      is-public: {}
      limit: {}
      message-id: {}
      query:
        simple: ${URL.Data}
      selected-fields: {}
      target-mailbox: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Searches for items in the specified mailbox. Specific permissions
        are needed for this operation to search in a target mailbox other than the
        default.
      id: 0b2d05ff-9fc9-477f-8248-76789d7143a3
      iscommand: true
      name: Search the exchange web services mailbox for the malicious URL
      script: '|||ews-search-mailbox'
      type: regular
      version: -1
    taskid: 0b2d05ff-9fc9-477f-8248-76789d7143a3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 895
        }
      }
  "22":
    evidencedata:
      customfields: {}
      description:
        simple: Recipients of the malicious URLs
    id: "22"
    ignoreworker: false
    note: true
    quietmode: 0
    scriptarguments:
      value:
        simple: ${EWS.Items.receivedBy}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: d65328b2-2357-4771-8583-58d322142342
      iscommand: false
      name: Print the name of email recipients containing the URL
      script: Print
      type: regular
      version: -1
    taskid: d65328b2-2357-4771-8583-58d322142342
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 500,
          "y": 1070
        }
      }
  "23":
    evidencedata:
      customfields: {}
      description:
        simple: Downloaded screenshot from slashnext
    id: "23"
    ignoreworker: false
    nexttasks:
      '#none#':
      - "14"
    note: true
    quietmode: 0
    scriptarguments:
      resolution: {}
      scanid:
        simple: ${SlashNext.URL.ScanID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Downloads a screenshot of a web page against a previous URL scan
        request.
      id: 7cf5390b-1be6-469f-8ca6-9dc3f9aeb707
      iscommand: true
      name: Download Screenshot from Slashnext
      script: '|||slashnext-download-screenshot'
      type: regular
      version: -1
    taskid: 7cf5390b-1be6-469f-8ca6-9dc3f9aeb707
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 930,
          "y": 895
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "3_5_#default#": 0.9
    },
    "paper": {
      "dimensions": {
        "height": 1610,
        "width": 1485,
        "x": 50,
        "y": 50
      }
    }
  }
tests:
- No tests (auto formatted)
fromversion: 6.0.0
description: 6.0.0

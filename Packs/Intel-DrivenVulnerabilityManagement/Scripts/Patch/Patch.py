import demistomock as demisto  # noqa: F401
from CommonServerPython import *  # noqa: F401

ids = demisto.args()['ids'].split(',')
internalhost = demisto.args()['internalhost'] if 'internalhost' in demisto.args() else None
demisto.results(str(ids))

for i in ids:
    demisto.results(i)
    d = demisto.executeCommand("addChildInvestigation", {
                               'name': 'Patch check for {}'.format(i), 'playbookName': 'Patch CVE - Manual'})
    childID = d[0]['Contents']['id']
    demisto.executeCommand("SetByIncidentId", {"id": childID, "key": "patchID", "value": i})
    demisto.executeCommand("setIncident", {"id": childID, "internalhost": internalhost})

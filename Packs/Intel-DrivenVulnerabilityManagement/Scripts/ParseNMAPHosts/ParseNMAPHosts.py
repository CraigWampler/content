import demistomock as demisto  # noqa: F401
from CommonServerPython import *  # noqa: F401

host = demisto.args()['host']


try:
    internalhost = host["hostnames"]["hostname"]["name"]
except:
    internalhost = host["address"]["addr"]

incArgs = {
    "name": f"NMAP {internalhost} Vulnerability Report",
    "type": "NMAP Host Report",
    'internalhost': internalhost,
    'tenableports': '0',
    'details': host,
    'src': internalhost
}

inc = demisto.executeCommand("createNewIncident", incArgs)[0]['EntryContext']['CreatedIncidentID']

demisto.results(inc)

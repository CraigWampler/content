import demistomock as demisto  # noqa: F401
from CommonServerPython import *  # noqa: F401

dArgs = demisto.args()
cve = dArgs['cve']

rep = None
cvss = cve["CVSS"] if 'CVSS' in cve else None

if cvss:

    if cvss >= 7:
        rep = {"md": "Bad", "score": 3}
    elif 4 < cvss < 7:
        rep = {"md": "Suspicious", "score": 2}
    elif 2 < cvss <= 4:
        red = {"md": "Good", "score": 1}
    else:
        rep = {"md": "Informational", "score": 0}

    md = f"{cve['ID']} determined to be {rep['md']} based on CVSS of {cvss}"

    entry = {
        'Type': entryTypes["note"],
        'Contents': md,
        'ContentsFormat': formats['markdown'],
        'HumanReadable': md,
        'ReadableContentsFormat': formats['markdown'],
        'EntryContext': {
            'CVE(val.ID)': {'DBotScore': rep['score'], 'DBotReputation': rep['md']}
        }
    }
    demisto.results(entry)

else:
    demisto.results(f"No CVSS score for {cve}")
